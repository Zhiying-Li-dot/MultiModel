# 第一章：基础概念

## 1.1 模态定义

**模态（Modality）** 指信息的不同表现形式或感知通道。

### 常见模态类型

| 模态 | 数据形式 | 特点 |
|------|----------|------|
| 文本 | 离散token序列 | 高度抽象、语义明确 |
| 图像 | 2D像素矩阵 | 空间结构、局部相关性强 |
| 音频 | 1D波形/频谱图 | 时序性、频率特征 |
| 视频 | 3D张量(时间+空间) | 时空连续性 |
| 3D点云 | 无序点集(x,y,z) | 稀疏、无规则结构 |

每种模态有独特的数据结构和统计特性，这决定了需要不同的编码方式。

### 模态特性对比

- **文本**：离散、序列化、语义密集
- **图像**：连续、空间结构、信息冗余
- **音频**：时序连续、频率特征丰富
- **视频**：时空连续、信息量巨大

---

## 1.2 多模态融合策略

### 早期融合 (Early Fusion)

```
┌─────────┐  ┌─────────┐
│ 图像特征 │  │ 文本特征 │
└────┬────┘  └────┬────┘
     │            │
     └─────┬──────┘
           ▼
    ┌─────────────┐
    │  拼接/相加   │  ← 在输入层或浅层融合
    └──────┬──────┘
           ▼
    ┌─────────────┐
    │  统一模型    │
    └─────────────┘
```

**特点**：
- 在输入层或浅层将不同模态拼接
- **优点**：模态间充分交互
- **缺点**：计算量大，需要对齐的数据

### 晚期融合 (Late Fusion)

```
┌─────────┐      ┌─────────┐
│ 图像特征 │      │ 文本特征 │
└────┬────┘      └────┬────┘
     ▼                ▼
┌─────────┐      ┌─────────┐
│ 视觉模型 │      │ 语言模型 │
└────┬────┘      └────┬────┘
     │                │
     └───────┬────────┘
             ▼
      ┌─────────────┐
      │  决策融合    │  ← 在输出层融合
      └─────────────┘
```

**特点**：
- 各模态独立编码后在决策层融合
- **优点**：各模态可独立预训练
- **缺点**：模态交互不充分

### 混合融合 (Hybrid Fusion)

- 在多个层级进行融合
- 结合早期和晚期融合的优点
- **是当前主流方案**

---

## 1.3 对齐与映射

### 核心问题

不同模态的特征空间不同，如何建立语义对应关系？

### CLIP对比学习示例

```
图像: [狗在草地上跑]  ──编码──▶  视觉向量 v₁
                                    ↕ 拉近距离
文本: "a dog running"  ──编码──▶  文本向量 t₁

图像: [猫在睡觉]      ──编码──▶  视觉向量 v₂
                                    ↕ 拉远距离
文本: "a dog running"  ──编码──▶  文本向量 t₁
```

### 对齐方法

#### 1. 对比学习 (Contrastive Learning)

- 拉近匹配的图文对
- 推远不匹配的图文对
- 代表：CLIP、ALIGN

#### 2. 投影层 (Projection Layer)

- 通过可学习矩阵将一个模态映射到另一个空间
- 简单高效
- 代表：LLaVA的MLP投影

#### 3. 交叉注意力 (Cross-Attention)

- 让一个模态去"查询"另一个模态的信息
- 灵活性强
- 代表：Flamingo、BLIP-2的Q-Former

### 对齐的数学表示

```python
# 对比学习损失函数 (InfoNCE)
def contrastive_loss(image_features, text_features, temperature=0.07):
    # 计算相似度矩阵
    logits = image_features @ text_features.T / temperature

    # 标签：对角线为正样本
    labels = torch.arange(len(logits))

    # 双向对比损失
    loss_i2t = F.cross_entropy(logits, labels)
    loss_t2i = F.cross_entropy(logits.T, labels)

    return (loss_i2t + loss_t2i) / 2
```

---

## 总结

| 概念 | 核心要点 |
|------|----------|
| 模态 | 不同的信息表现形式，各有特点 |
| 融合策略 | 早期、晚期、混合融合各有优缺点 |
| 对齐 | 建立不同模态间的语义对应关系 |

理解这些基础概念是学习多模态大模型的第一步。
